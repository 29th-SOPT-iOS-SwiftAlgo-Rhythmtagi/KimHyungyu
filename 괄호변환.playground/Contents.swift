///*
//ðŸ“Œ ìš©ì–´ì™€ ì •ì˜
//- ê· í˜•ìž¡ížŒ ê´„í˜¸ ë¬¸ìžì—´ : '(' ì™€ ')' ë¡œë§Œ ì´ë£¨ì–´ì§„ ë¬¸ìžì—´ì´ ìžˆì„ ê²½ìš°, '(' ì˜ ê°œìˆ˜ì™€ ')' ì˜ ê°œìˆ˜ê°€ ê°™ë‹¤
//- ì˜¬ë°”ë¥¸ ê´„í˜¸ ë¬¸ìžì—´ : ê· í˜•ìž¡ížŒ ê´„í˜¸ ë¬¸ìžì—´ì—ì„œ '('ì™€ ')'ì˜ ê´„í˜¸ì˜ ì§ë„ ëª¨ë‘ ë§žì„ ê²½ìš°
//
//ðŸ“Œ ì£¼ì–´ì§„ ì•Œê³ ë¦¬ì¦˜ :
//1. ìž…ë ¥ì´ ë¹ˆ ë¬¸ìžì—´ì¸ ê²½ìš°, ë¹ˆ ë¬¸ìžì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
//2. ë¬¸ìžì—´ wë¥¼ ë‘ "ê· í˜•ìž¡ížŒ ê´„í˜¸ ë¬¸ìžì—´" u, vë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤. ë‹¨, uëŠ” "ê· í˜•ìž¡ížŒ ê´„í˜¸ ë¬¸ìžì—´"ë¡œ ë” ì´ìƒ ë¶„ë¦¬í•  ìˆ˜ ì—†ì–´ì•¼ í•˜ë©°, vëŠ” ë¹ˆ ë¬¸ìžì—´ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
//3. ë¬¸ìžì—´ uê°€ "ì˜¬ë°”ë¥¸ ê´„í˜¸ ë¬¸ìžì—´" ì´ë¼ë©´ ë¬¸ìžì—´ vì— ëŒ€í•´ 1ë‹¨ê³„ë¶€í„° ë‹¤ì‹œ ìˆ˜í–‰í•©ë‹ˆë‹¤.
//  3-1. ìˆ˜í–‰í•œ ê²°ê³¼ ë¬¸ìžì—´ì„ uì— ì´ì–´ ë¶™ì¸ í›„ ë°˜í™˜í•©ë‹ˆë‹¤.
//4. ë¬¸ìžì—´ uê°€ "ì˜¬ë°”ë¥¸ ê´„í˜¸ ë¬¸ìžì—´"ì´ ì•„ë‹ˆë¼ë©´ ì•„ëž˜ ê³¼ì •ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
//  4-1. ë¹ˆ ë¬¸ìžì—´ì— ì²« ë²ˆì§¸ ë¬¸ìžë¡œ '('ë¥¼ ë¶™ìž…ë‹ˆë‹¤.
//  4-2. ë¬¸ìžì—´ vì— ëŒ€í•´ 1ë‹¨ê³„ë¶€í„° ìž¬ê·€ì ìœ¼ë¡œ ìˆ˜í–‰í•œ ê²°ê³¼ ë¬¸ìžì—´ì„ ì´ì–´ ë¶™ìž…ë‹ˆë‹¤.
//  4-3. ')'ë¥¼ ë‹¤ì‹œ ë¶™ìž…ë‹ˆë‹¤.
//  4-4. uì˜ ì²« ë²ˆì§¸ì™€ ë§ˆì§€ë§‰ ë¬¸ìžë¥¼ ì œê±°í•˜ê³ , ë‚˜ë¨¸ì§€ ë¬¸ìžì—´ì˜ ê´„í˜¸ ë°©í–¥ì„ ë’¤ì§‘ì–´ì„œ ë’¤ì— ë¶™ìž…ë‹ˆë‹¤.
//  4-5. ìƒì„±ëœ ë¬¸ìžì—´ì„ ë°˜í™˜í•©ë‹ˆë‹¤.
//
//ðŸ“Œ í¬ì¸íŠ¸
//- ì£¼ì–´ì§„ ì¡°ê±´ í™œìš©
//- ìž¬ê·€
//*/
import Foundation

func solution(_ p:String) -> String {

    // âœ… 1ë‹¨ê³„ë¡œ í–¥í•˜ëŠ” ìž¬ê·€í•¨ìˆ˜ ì—­í• 
    func gotoFirstStep(_ w: String) -> String {
        var checkPair = ["(": 0, ")": 0]
        var checkStack: [String] = []
        var u: String = ""
        var v: String = ""
        let array = w.map { String($0) }

        for index in 0..<w.count {
            let s = array[index]
            // âœ… "(" ê²½ìš°
            if s == "(" {
                checkStack.append(s)
                checkPair["("]! += 1
            }
            // âœ… ")" ê²½ìš°
            else {
                // âœ… 'ì˜¬ë°”ë¥¸ ê´„í˜¸ ë¬¸ìžì—´' ì´ë¼ê³  íŒë‹¨
                if let last = checkStack.last, last == "(" {
                    checkStack.removeLast()
                }
                // âœ… ì•„ì§ 'ì˜¬ë°”ë¥¸ ê´„í˜¸ ë¬¸ìžì—´' ì´ë¼ê³  íŒë‹¨í•˜ì§€ ì•ŠìŒ
                else {
                    checkStack.append(s)
                }
                checkPair[")"]! += 1
            }
            // âœ… ì§€ê¸ˆê¹Œì§€ 'ê· í˜•ìž¡ížŒ ê´„í˜¸ ë¬¸ìžì—´' ì˜ ë§ˆì§€ë§‰ index ë¥¼ ì°¾ëŠ” ê³¼ì •

            // ðŸ“Œ 2ë‹¨ê³„: 'ê· í˜•ìž¡ížŒ ê´„í˜¸ ë¬¸ìžì—´' u ì™€ v ë¡œ ë¶„ë¦¬
            if checkPair["("] != 0, checkPair["("] == checkPair[")"] {
                // âœ… u
                u = array[0...index].map { String($0) }.joined()
                if index + 1 <= w.count {
                    // âœ… v
                    v = array[index + 1..<w.count].map { String($0) }.joined()
                }
                // ðŸ“Œ 3ë‹¨ê³„: 'ì˜¬ë°”ë¥¸ ê´„í˜¸ ë¬¸ìžì—´' ì˜ ê²½ìš°
                if checkStack.isEmpty {
                    return u + gotoFirstStep(v)
                }
                // ðŸ“Œ 4ë‹¨ê³„: 'ì˜¬ë°”ë¥¸ ê´„í˜¸ ë¬¸ìžì—´' ì´ ì•„ë‹ ê²½ìš°
                else {
                    u.removeFirst()
                    u.removeLast()

                    return "(" + gotoFirstStep(v) + ")" + reverse(u)
                }
            }
        }
        // ðŸ“Œ 1ë‹¨ê³„: ìž…ë ¥ì´ ë¹ˆë¬¸ìžì—´ì¼ ê²½ìš°.
        return ""
    }

    // ðŸ“Œ 4-4ë‹¨ê³„: ë¬¸ìžì—´ì˜ ê´„í˜¸ ë°©í–¥ì„ ë’¤ì§‘ì–´ì„œ ë’¤ì— ë¶™ì¸ë‹¤.
    func reverse(_ u: String) -> String {
        return u.map { $0 == "(" ? ")" : "("}.joined()
    }

    // âœ… ì‹¤í–‰
    return gotoFirstStep(p)
}
